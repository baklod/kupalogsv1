<!DOCTYPE html>
<html>
  <head>
    <title>44D T-Shirt Customizer</title>
    <style>
      body {
        margin: 0;
      }
      canvas {
        display: block;
      }
      .controls {
        position: absolute;
        top: 20px;
        left: 20px;
        background: white;
        padding: 10px;
        z-index: 10;
      }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
  </head>
  <body>
    <div class="controls">
      <label
        >Color: <input type="color" id="colorPicker" value="#ffffff" /></label
      ><br />
      <label
        >Fabric Style:
        <select id="fabricSelect">
          <option value="plain">Plain</option>
          <option value="stripes">Stripes</option>
          <option value="camouflage">Camouflage</option>
        </select>
      </label>
    </div>

    <script>
      let scene, camera, renderer, controls, tshirt, baseMaterial;

      function init() {
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(
          75,
          window.innerWidth / window.innerHeight,
          0.1,
          1000
        );
        camera.position.z = 3;

        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        controls = new THREE.OrbitControls(camera, renderer.domElement);

        const light = new THREE.AmbientLight(0xffffff, 1);
        scene.add(light);

        baseMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff });

        const loader = new THREE.GLTFLoader();
        loader.load("/models/tshirt.glb", function (gltf) {
          tshirt = gltf.scene;
          tshirt.traverse((child) => {
            if (child.isMesh) {
              child.material = baseMaterial;
            }
          });
          scene.add(tshirt);
        });

        animate();
      }

      function animate() {
        requestAnimationFrame(animate);
        renderer.render(scene, camera);
      }

      // Change color
      document.getElementById("colorPicker").addEventListener("input", (e) => {
        baseMaterial.color.set(e.target.value);
      });

      // Change fabric
      document
        .getElementById("fabricSelect")
        .addEventListener("change", (e) => {
          const fabric = e.target.value;
          let textureUrl = null;

          switch (fabric) {
            case "plain":
              baseMaterial.map = null;
              baseMaterial.needsUpdate = true;
              break;
            case "stripes":
              textureUrl = "/textures/stripes.jpg";
              break;
            case "camouflage":
              textureUrl = "/textures/camo.jpg";
              break;
          }

          if (textureUrl) {
            const loader = new THREE.TextureLoader();
            loader.load(textureUrl, (texture) => {
              baseMaterial.map = texture;
              baseMaterial.needsUpdate = true;
            });
          }
        });

      window.onload = init;
    </script>
  </body>
</html>
